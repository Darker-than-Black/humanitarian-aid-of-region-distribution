<div #upScrollRef class="up-scroll">
  <div #upScrollRowRef class="up-scroll__row"></div>
</div>

<p-table
  #tableRef
  class="goods-table"
  [value]="data"
  [columns]="config"
  [loading]="loading"
  [globalFilterFields]="filterableFields"
  [rows]="localTableSettings.rows"
  [paginator]="localTableSettings.paginator"
  [filterDelay]="localTableSettings.filterDelay"
  [rowsPerPageOptions]="localTableSettings.rowsPerPageOptions"
  [showCurrentPageReport]="localTableSettings.showCurrentPageReport"
  [currentPageReportTemplate]="localTableSettings.currentPageReportTemplate"
>

  <ng-template pTemplate="caption">
    <span class="p-input-icon-left p-ml-auto">
      <i class="pi pi-search"></i>
      <input
        pInputText
        type="text"
        placeholder="Search keyword"
        (input)="tableRef.filterGlobal($any($event.target).value, 'contains')"
      />
    </span>

    <ng-container *ngTemplateOutlet="captionTemplate || null"></ng-container>
  </ng-template>

  <ng-template pTemplate="header">
    <tr>
      <th *ngFor="let col of config">{{ col.label }}</th>
    </tr>

    <tr *ngIf="filterableFields.length">
      <th *ngFor="let col of config">
        <div
          *ngIf="col.filterable"
          [style.minWidth]="col.minWidth || localTableSettings.colMinWidth"
        >
          <p-columnFilter
            type="text"
            matchMode="contains"
            [field]="col.key"
            [showMenu]="false"
            [showClearButton]="false"
          ></p-columnFilter>
        </div>
      </th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-item>
    <tr class="goods-table__row">
      <td *ngFor="let column of config" class="goods-table__td">
        <app-table-data
          [template]="tdTemplate"
          [config]="column"
          [item]="item"
        ></app-table-data>

        <ng-template #tdTemplate let-data let-item="item">
          <ng-container *ngTemplateOutlet="
            tableDataTemplate || null
            context: { $implicit: data, item: item, config: column }"
          ></ng-container>
        </ng-template>
      </td>
    </tr>
  </ng-template>

  <ng-template pTemplate="emptymessage">
    <tr>
      <td [attr.colspan]="config.length">{{ localTableSettings.emptyMessage }}</td>
    </tr>
  </ng-template>
</p-table>

